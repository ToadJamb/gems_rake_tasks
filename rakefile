require_relative 'lib/rake_tasks'

require 'rspec/core/rake_task'
require 'cane/rake_task'

RSpec::Core::RakeTask.new(:spec) do |task|
  task.ruby_opts = '-w'
  #task.rspec_opts = '--format documentation'
  #task.pattern = 'spec/**/*_save_config_spec.rb'
end

namespace :cane do
  glob_pattern = '{bin,lib,spec,test}/**/*.rb'

  desc 'Run cane to check quality metrics'
  Cane::RakeTask.new(:quality) do |cane|
    cane.abc_max = 9
    cane.no_doc = true

    cane.abc_glob   = glob_pattern
    cane.style_glob = glob_pattern
  end

  desc 'Run cane to check quality metrics'
  Cane::RakeTask.new(:warn) do |cane|
    cane.abc_max = 8
    cane.no_doc = true

    cane.abc_glob   = glob_pattern
    cane.style_glob = glob_pattern
  end
end

Rake::Task[:default].clear_prerequisites
task default: ['cane:quality', :spec, 'test:all']
